<div class="container mt-5">
    <div class="text-center mb-4">
        <h2 class="fw-bold text-primary">🏐 隊伍數據檢視 🏐</h2>
        <p class="text-muted">查看所有隊員的最新比賽數據</p>
    </div>

    <div class="table-responsive">
        <table class="table table-hover table-bordered shadow-sm rounded">
            <thead class="table-primary text-center">
                <tr>
                    <th>排名</th>
                    <th>球員名稱</th>
                    <th>攻擊得分</th>
                    <th>防守得分</th>
                    <th>接球得分</th>
                    <th>舉球得分</th>
                    <th>攔網得分</th>
                    <th>發球得分</th>
                    <th>總得分</th>
                </tr>
            </thead>
            <tbody class="text-center">
                <% 
                    let totalAttack = 0, totalDefense = 0, totalReceive = 0, totalSet = 0, totalBlock = 0, totalServe = 0, totalTotal = 0;
                    teamStats.forEach((player, index) => { 
                        totalAttack += parseFloat(player.attack_point);
                        totalDefense += parseFloat(player.defense_point);
                        totalReceive += parseFloat(player.receive_point);
                        totalSet += parseFloat(player.set_point);
                        totalBlock += parseFloat(player.block_point);
                        totalServe += parseFloat(player.serve_point);
                        totalTotal += parseFloat(player.total_point);
                %>
                    <tr>
                        <!-- 顯示排名，index + 1 是為了從 1 開始計數 -->
                        <td><%= index + 1 %></td>
                        
                        <!-- 前五名球員名稱顯示不同顏色，這裡使用 text-primary 來顯示藍色 -->
                        <td class="fw-bold <%= index < 5 ? 'text-primary' : '' %> fs-5">
                            <%= player.player_name %>
                        </td>
                        <td><span class="badge bg-danger px-3 py-1 fs-6"><%= Number(player.attack_point).toFixed(2) %></span></td>
                        <td><span class="badge bg-success px-3 py-1 fs-6"><%= Number(player.defense_point).toFixed(2) %></span></td>
                        <td><span class="badge bg-warning text-dark px-3 py-1 fs-6"><%= Number(player.receive_point).toFixed(2) %></span></td>
                        <td><span class="badge bg-info text-dark px-3 py-1 fs-6"><%= Number(player.set_point).toFixed(2) %></span></td>
                        <td><span class="badge bg-secondary px-3 py-1 fs-6"><%= Number(player.block_point).toFixed(2) %></span></td>
                        <td><span class="badge bg-dark px-3 py-1 fs-6"><%= Number(player.serve_point).toFixed(2) %></span></td>
                        <td class="fw-bold fs-5 text-success"><%= Number(player.total_point).toFixed(2) %></td>
                    </tr>
                <% }) %>
            </tbody>
            <tfoot>
                <tr class="table-info fw-bold text-center">
                    <!-- 平均行，排名欄位留空 -->
                    <td></td>
                    <td>平均</td>
                    <td><span class="badge bg-danger px-3 py-1 fs-6"><%= (totalAttack / teamStats.length).toFixed(2) %></span></td>
                    <td><span class="badge bg-success px-3 py-1 fs-6"><%= (totalDefense / teamStats.length).toFixed(2) %></span></td>
                    <td><span class="badge bg-warning text-dark px-3 py-1 fs-6"><%= (totalReceive / teamStats.length).toFixed(2) %></span></td>
                    <td><span class="badge bg-info text-dark px-3 py-1 fs-6"><%= (totalSet / teamStats.length).toFixed(2) %></span></td>
                    <td><span class="badge bg-secondary px-3 py-1 fs-6"><%= (totalBlock / teamStats.length).toFixed(2) %></span></td>
                    <td><span class="badge bg-dark px-3 py-1 fs-6"><%= (totalServe / teamStats.length).toFixed(2) %></span></td>
                    <td class="fw-bold fs-5 text-success"><%= (totalTotal / teamStats.length).toFixed(2) %></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <!-- 返回按鈕區塊 -->
    <div class="text-center mt-4">
        <a href="/" class="btn btn-outline-primary btn-lg mx-2">🏠 返回首頁</a>
        <a href="/manager" class="btn btn-outline-dark btn-lg mx-2">⚙️ 返回管理頁面</a>
    </div>
</div>
